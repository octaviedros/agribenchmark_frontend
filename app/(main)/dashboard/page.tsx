import { promises as fs } from "fs"
import path from "path"
import { z } from "zod"
import { farmSchema } from "@/data/schema"
import { DashboardClient } from "./DashboardClient"
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "Dashboard | agribenchmark",
  description: "Generated by global networks",
};

export default async function Dashboard() {
  // TODO: Fetch data from the database
  const data = await fs.readFile(path.join(process.cwd(), "data/farms.json"))
  const farms = JSON.parse(data.toString())
  const validatedFarms = z.array(farmSchema).parse(farms)

  return <DashboardClient farms={validatedFarms} />
}